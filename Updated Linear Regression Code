import pandas as pd
import numpy as np
from sklearn import datasets, linear_model
from sklearn.metrics import mean_squared_error
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt
from scipy import stats


chunk = pd.read_csv('NY DATAFRAME FINAL.csv',chunksize = 10000000)
df_NY = pd.concat(chunk)

chunk = pd.read_csv('LA DATAFRAME FINAL.csv',chunksize = 10000000)
df_LA = pd.concat(chunk)

chunk = pd.read_csv('CHICAGO DATAFRAME FINAL.csv',chunksize = 10000000)
df_CHI = pd.concat(chunk)


#Test whether the datasets are statistically different 
#Perform a linear regression:
#More precisely, linear regression is used to determine the character and strength 
#of the association between a dependent variable and a series of other independent 
#variables
#Do victims have an effect as a dependent variable?
#Normal graph to show trends over time


contingency_NY = pd.crosstab(df_NY['CRIME_DESCRIPTION'], df_NY['YEAR'])
contingency_LA = pd.crosstab(df_LA['CRIME_DESCRIPTION'], df_LA['YEAR'])
contingency_CHI = pd.crosstab(df_CHI['CRIME_DESCRIPTION'], df_CHI['YEAR'])
print(contingency_CHI)
# contingency_CHI.info()

#CHI Linear regression

##CHANGE contigency_NY to contigency_LA
NYarson = contingency_NY.iloc[0, :].values.reshape((-1, 1))
NYbattery = contingency_NY.iloc[1, :].values.reshape((-1, 1))
NYburglary = contingency_NY.iloc[2, :].values.reshape((-1, 1))
NYdangerousWeapons= contingency_NY.iloc[3, :].values.reshape((-1, 1))
NYhomicide = contingency_NY.iloc[4, :].values.reshape((-1, 1))
NYnarcotics = contingency_NY.iloc[5, :].values.reshape((-1, 1))
NYpetitLarceny = contingency_NY.iloc[6, :].values.reshape((-1, 1))
NYrobbery = contingency_NY.iloc[7, :].values.reshape((-1, 1))
NYsexualAssault = contingency_NY.iloc[8, :].values.reshape((-1, 1))

LAarson = contingency_LA.iloc[0, :].values.reshape((-1, 1))
LAbattery = contingency_LA.iloc[1, :].values.reshape((-1, 1))
LAburglary = contingency_LA.iloc[2, :].values.reshape((-1, 1))
LAdangerousWeapons= contingency_LA.iloc[3, :].values.reshape((-1, 1))
LAhomicide = contingency_LA.iloc[4, :].values.reshape((-1, 1))
LAnarcotics = contingency_LA.iloc[5, :].values.reshape((-1, 1))
LApetitLarceny = contingency_LA.iloc[6, :].values.reshape((-1, 1))
LArobbery = contingency_LA.iloc[7, :].values.reshape((-1, 1))
LAsexualAssault = contingency_LA.iloc[8, :].values.reshape((-1, 1))


arson = contingency_CHI.iloc[0, :].values.reshape((-1,1))  
battery = contingency_CHI.iloc[1, :].values.reshape((-1,1)) 
burglary = contingency_CHI.iloc[2, :].values.reshape((-1,1))  
dangerousWeapons= contingency_CHI.iloc[3, :].values.reshape((-1,1)) 
homicide = contingency_CHI.iloc[4, :].values.reshape((-1,1))  
narcotics = contingency_CHI.iloc[5, :].values.reshape((-1,1)) 
petitLarceny = contingency_CHI.iloc[6, :].values.reshape((-1,1))
robbery = contingency_CHI.iloc[7, :].values.reshape((-1,1))  
sexualAssault = contingency_CHI.iloc[8, :].values.reshape((-1,1)) 
Year = np.array([1,2,3,4,5]).reshape((-1,1))




##NY to LA
NYmodel1 = LinearRegression().fit(Year, NYarson)
NYmodel2 = LinearRegression().fit(Year, NYbattery)
NYmodel3 = LinearRegression().fit(Year, NYburglary)
NYmodel4 = LinearRegression().fit(Year, NYdangerousWeapons)
NYmodel5 = LinearRegression().fit(Year, NYhomicide)
NYmodel6 = LinearRegression().fit(Year, NYnarcotics)
NYmodel7 = LinearRegression().fit(Year, NYpetitLarceny)
NYmodel8 = LinearRegression().fit(Year, NYrobbery)
NYmodel9 = LinearRegression().fit(Year, NYsexualAssault)

LAmodel1 = LinearRegression().fit(Year, LAarson)
LAmodel2 = LinearRegression().fit(Year, LAbattery)
LAmodel3 = LinearRegression().fit(Year, LAburglary)
LAmodel4 = LinearRegression().fit(Year, LAdangerousWeapons)
LAmodel5 = LinearRegression().fit(Year, LAhomicide)
LAmodel6 = LinearRegression().fit(Year, LAnarcotics)
LAmodel7 = LinearRegression().fit(Year, LApetitLarceny)
LAmodel8 = LinearRegression().fit(Year, LArobbery)
LAmodel9 = LinearRegression().fit(Year, LAsexualAssault)

CHImodel1 = LinearRegression().fit(Year, arson)
CHImodel2 = LinearRegression().fit(Year, battery)
CHImodel3 = LinearRegression().fit(Year, burglary)
CHImodel4 = LinearRegression().fit(Year, dangerousWeapons)
CHImodel5 = LinearRegression().fit(Year, homicide)
CHImodel6 = LinearRegression().fit(Year, narcotics)
CHImodel7 = LinearRegression().fit(Year, petitLarceny)
CHImodel8 = LinearRegression().fit(Year, robbery)
CHImodel9 = LinearRegression().fit(Year, sexualAssault)

print(plt.scatter(Year, NYarson))
print(plt.title("Arson"))
plt.plot(Year, NYmodel1.coef_ * Year + NYmodel1.intercept_)
r_sq = NYmodel1.score(Year, NYarson)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel1.intercept_}")
print(f"The slope is : {NYmodel1.coef_}")
y_pred1 = NYmodel1.predict(Year)
print(f"The predicted responses are: \n{y_pred1}")
print()


r_sq = LAmodel1.score(Year, LAarson)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel1.intercept_}")
print(f"The slope is : {LAmodel1.coef_}")
y_pred1 = LAmodel1.predict(Year)
print(f"The predicted responses are: \n{y_pred1}")
print(plt.scatter(Year, LAarson))
plt.plot(Year, LAmodel1.coef_ * Year + LAmodel1.intercept_)
print()

print(plt.scatter(Year, arson))
plt.plot(Year, CHImodel1.coef_ * Year + CHImodel1.intercept_)
r_sq = CHImodel2.score(Year, battery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel2.intercept_}")
print(f"The slope is : {CHImodel2.coef_}")
y_pred2 = CHImodel2.predict(Year)
print(f"The predicted responses are: \n{y_pred2}")
print()

print(plt.scatter(Year, NYbattery))
print(plt.title("Battery"))
plt.plot(Year, NYmodel2.coef_ * Year + NYmodel2.intercept_)
r_sq = NYmodel2.score(Year, NYbattery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel2.intercept_}")
print(f"The slope is : {NYmodel2.coef_}")
y_pred2 = NYmodel2.predict(Year)
print(f"The predicted responses are: \n{y_pred2}")
print()

print(plt.scatter(Year, LAbattery))
plt.plot(Year, LAmodel2.coef_ * Year + LAmodel2.intercept_)
r_sq = LAmodel2.score(Year, LAbattery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel2.intercept_}")
print(f"The slope is : {LAmodel2.coef_}")
y_pred2 = LAmodel2.predict(Year)
print(f"The predicted responses are: \n{y_pred2}")
print()

print(plt.scatter(Year, battery))
plt.plot(Year, CHImodel2.coef_ * Year + CHImodel2.intercept_)
r_sq = CHImodel2.score(Year, battery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel2.intercept_}")
print(f"The slope is : {CHImodel2.coef_}")
y_pred2 = CHImodel2.predict(Year)
print(f"The predicted responses are: \n{y_pred2}")
print()

print(plt.scatter(Year, NYburglary))
print(plt.title("Burglary"))
plt.plot(Year, NYmodel3.coef_ * Year + NYmodel3.intercept_)
r_sq = NYmodel3.score(Year, NYburglary)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel3.intercept_}")
print(f"The slope is : {NYmodel3.coef_}")
y_pred3 = NYmodel3.predict(Year)
print(f"The predicted responses are: \n{y_pred3}")
print()

print(plt.scatter(Year, LAburglary))
plt.plot(Year, LAmodel3.coef_ * Year + LAmodel3.intercept_)
r_sq = LAmodel3.score(Year, LAburglary)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel3.intercept_}")
print(f"The slope is : {LAmodel3.coef_}")
y_pred3 = LAmodel3.predict(Year)
print(f"The predicted responses are: \n{y_pred3}")
print()

print(plt.scatter(Year, burglary))
plt.plot(Year, CHImodel3.coef_ * Year + CHImodel3.intercept_)
r_sq = CHImodel3.score(Year, burglary)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel3.intercept_}")
print(f"The slope is : {CHImodel3.coef_}")
y_pred3 = CHImodel3.predict(Year)
print(f"The predicted responses are: \n{y_pred3}")
print()

print(plt.scatter(Year, NYdangerousWeapons))
print(plt.title("Dangerous Weapons"))
plt.plot(Year, NYmodel4.coef_ * Year + NYmodel4.intercept_)
r_sq = NYmodel4.score(Year, NYdangerousWeapons)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel4.intercept_}")
print(f"The slope is : {NYmodel4.coef_}")
y_pred4 = NYmodel4.predict(Year)
print(f"The predicted responses are: \n{y_pred4}")
print()

print(plt.scatter(Year, LAdangerousWeapons))
plt.plot(Year, LAmodel4.coef_ * Year + LAmodel4.intercept_)
r_sq = LAmodel4.score(Year, LAdangerousWeapons)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel4.intercept_}")
print(f"The slope is : {LAmodel4.coef_}")
y_pred4 = LAmodel4.predict(Year)
print(f"The predicted responses are: \n{y_pred4}")
print()

print(plt.scatter(Year, dangerousWeapons))
plt.plot(Year, CHImodel4.coef_ * Year + CHImodel4.intercept_)
r_sq = CHImodel4.score(Year, dangerousWeapons)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel4.intercept_}")
print(f"The slope is : {CHImodel4.coef_}")
y_pred4 = CHImodel4.predict(Year)
print(f"The predicted responses are: \n{y_pred4}")
print()

print(plt.scatter(Year, NYhomicide))
print(plt.title("Homicide"))
plt.plot(Year, NYmodel5.coef_ * Year + NYmodel5.intercept_)
r_sq = NYmodel5.score(Year, NYhomicide)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel5.intercept_}")
print(f"The slope is : {NYmodel5.coef_}")
y_pred5 = NYmodel5.predict(Year)
print(f"The predicted responses are: \n{y_pred5}")
print()

print(plt.scatter(Year, LAhomicide))
plt.plot(Year, LAmodel5.coef_ * Year + LAmodel5.intercept_)
r_sq = LAmodel5.score(Year, LAhomicide)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel5.intercept_}")
print(f"The slope is : {LAmodel5.coef_}")
y_pred5 = LAmodel5.predict(Year)
print(f"The predicted responses are: \n{y_pred5}")
print()

print(plt.scatter(Year, homicide))
plt.plot(Year, CHImodel5.coef_ * Year + CHImodel5.intercept_)
r_sq = CHImodel5.score(Year, homicide)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel5.intercept_}")
print(f"The slope is : {CHImodel5.coef_}")
y_pred5 = CHImodel5.predict(Year)
print(f"The predicted responses are: \n{y_pred5}")
print()

print(plt.scatter(Year, NYnarcotics))
print(plt.title("Narcotics"))
plt.plot(Year, NYmodel6.coef_ * Year + NYmodel6.intercept_)
r_sq = NYmodel6.score(Year, NYnarcotics)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel6.intercept_}")
print(f"The slope is : {NYmodel6.coef_}")
y_pred6 = NYmodel6.predict(Year)
print(f"The predicted responses are: \n{y_pred6}")
print()

print(plt.scatter(Year, LAnarcotics))
plt.plot(Year, LAmodel6.coef_ * Year + LAmodel6.intercept_)
r_sq = LAmodel6.score(Year, LAnarcotics)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel6.intercept_}")
print(f"The slope is : {LAmodel6.coef_}")
y_pred6 = LAmodel6.predict(Year)
print(f"The predicted responses are: \n{y_pred6}")
print()

print(plt.scatter(Year, narcotics))
plt.plot(Year, CHImodel6.coef_ * Year + CHImodel6.intercept_)
r_sq = CHImodel6.score(Year, narcotics)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel6.intercept_}")
print(f"The slope is : {CHImodel6.coef_}")
y_pred6 = CHImodel6.predict(Year)
print(f"The predicted responses are: \n{y_pred6}")
print()

print(plt.scatter(Year, NYpetitLarceny))
print(plt.title("Petit Larceny"))
plt.plot(Year, NYmodel7.coef_ * Year + NYmodel7.intercept_)
r_sq = NYmodel7.score(Year, NYpetitLarceny)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel7.intercept_}")
print(f"The slope is : {NYmodel7.coef_}")
y_pred7 = NYmodel7.predict(Year)
print(f"The predicted responses are: \n{y_pred7}")
print()

print(plt.scatter(Year, LApetitLarceny))
plt.plot(Year, LAmodel7.coef_ * Year + LAmodel7.intercept_)
r_sq = LAmodel7.score(Year, LApetitLarceny)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel7.intercept_}")
print(f"The slope is : {LAmodel7.coef_}")
y_pred7 = LAmodel7.predict(Year)
print(f"The predicted responses are: \n{y_pred7}")
print()

print(plt.scatter(Year, petitLarceny))
plt.plot(Year, CHImodel7.coef_ * Year + CHImodel7.intercept_)
r_sq = CHImodel7.score(Year, petitLarceny)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel7.intercept_}")
print(f"The slope is : {CHImodel7.coef_}")
y_pred7 = CHImodel7.predict(Year)
print(f"The predicted responses are: \n{y_pred7}")
print()

print(plt.scatter(Year, NYrobbery))
print(plt.title("Robbery"))
plt.plot(Year, NYmodel8.coef_ * Year + NYmodel8.intercept_)
r_sq = NYmodel8.score(Year, NYrobbery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel8.intercept_}")
print(f"The slope is : {NYmodel8.coef_}")
y_pred8 = NYmodel8.predict(Year)
print(f"The predicted responses are: \n{y_pred8}")
print()

print(plt.scatter(Year, LArobbery))
plt.plot(Year, LAmodel8.coef_ * Year + LAmodel8.intercept_)
r_sq = LAmodel8.score(Year, LArobbery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel8.intercept_}")
print(f"The slope is : {LAmodel8.coef_}")
y_pred8 = LAmodel8.predict(Year)
print(f"The predicted responses are: \n{y_pred8}")
print()

print(plt.scatter(Year, robbery))
plt.plot(Year, CHImodel8.coef_ * Year + CHImodel8.intercept_)
r_sq = CHImodel8.score(Year, robbery)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel8.intercept_}")
print(f"The slope is : {CHImodel8.coef_}")
y_pred8 = CHImodel8.predict(Year)
print(f"The predicted responses are: \n{y_pred8}")
print()

print(plt.scatter(Year, NYsexualAssault))
print(plt.title("Sexual Assault"))
plt.plot(Year, NYmodel9.coef_ * Year + NYmodel9.intercept_)
r_sq = NYmodel9.score(Year, NYsexualAssault)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {NYmodel9.intercept_}")
print(f"The slope is : {NYmodel9.coef_}")
y_pred9 = NYmodel9.predict(Year)
print(f"The predicted responses are: \n{y_pred9}")
print()

print(plt.scatter(Year, LAsexualAssault))
plt.plot(Year, LAmodel9.coef_ * Year + LAmodel9.intercept_)
r_sq = LAmodel9.score(Year, LAsexualAssault)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {LAmodel9.intercept_}")
print(f"The slope is : {LAmodel9.coef_}")
y_pred9 = LAmodel9.predict(Year)
print(f"The predicted responses are: \n{y_pred9}")
print()

print(plt.scatter(Year, sexualAssault))
plt.plot(Year, CHImodel9.coef_ * Year + CHImodel9.intercept_)
r_sq = CHImodel9.score(Year, sexualAssault)
print(f"The coefficient of determination is: {r_sq}")
print(f"The intercept is: {CHImodel9.intercept_}")
print(f"The slope is : {CHImodel9.coef_}")
y_pred9 = CHImodel9.predict(Year)
print(f"The predicted responses are: \n{y_pred9}")
print()
